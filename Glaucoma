{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "6b62c07d",
   "metadata": {
    "_cell_guid": "b1076dfc-b9ad-4769-8c92-a6c4dae69d19",
    "_uuid": "8f2839f25d086af736a60e9eeb907d3b93b6e0e5",
    "execution": {
     "iopub.execute_input": "2025-08-17T15:47:47.782484Z",
     "iopub.status.busy": "2025-08-17T15:47:47.782172Z",
     "iopub.status.idle": "2025-08-17T15:50:51.134489Z",
     "shell.execute_reply": "2025-08-17T15:50:51.133492Z"
    },
    "papermill": {
     "duration": 183.357008,
     "end_time": "2025-08-17T15:50:51.135965",
     "exception": false,
     "start_time": "2025-08-17T15:47:47.778957",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/usr/local/lib/python3.11/dist-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.\n",
      "  warnings.warn(\n",
      "/usr/local/lib/python3.11/dist-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ViT_B_16_Weights.IMAGENET1K_V1`. You can also use `weights=ViT_B_16_Weights.DEFAULT` to get the most up-to-date weights.\n",
      "  warnings.warn(msg)\n",
      "Downloading: \"https://download.pytorch.org/models/vit_b_16-c867db91.pth\" to /root/.cache/torch/hub/checkpoints/vit_b_16-c867db91.pth\n",
      "100%|██████████| 330M/330M [00:01<00:00, 189MB/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Using Vision Transformer (ViT) model: ViT-B/16\n",
      "Starting training...\n",
      "Epoch [1/20], Loss: 0.6565\n",
      "Epoch [2/20], Loss: 0.5488\n",
      "Epoch [3/20], Loss: 0.4689\n",
      "Epoch [4/20], Loss: 0.4129\n",
      "Epoch [5/20], Loss: 0.3713\n",
      "Epoch [6/20], Loss: 0.3388\n",
      "Epoch [7/20], Loss: 0.3137\n",
      "Epoch [8/20], Loss: 0.2927\n",
      "Epoch [9/20], Loss: 0.2760\n",
      "Epoch [10/20], Loss: 0.2603\n",
      "Epoch [11/20], Loss: 0.2476\n",
      "Epoch [12/20], Loss: 0.2365\n",
      "Epoch [13/20], Loss: 0.2274\n",
      "Epoch [14/20], Loss: 0.2179\n",
      "Epoch [15/20], Loss: 0.2103\n",
      "Epoch [16/20], Loss: 0.2033\n",
      "Epoch [17/20], Loss: 0.1968\n",
      "Epoch [18/20], Loss: 0.1912\n",
      "Epoch [19/20], Loss: 0.1857\n",
      "Epoch [20/20], Loss: 0.1806\n",
      "Training finished.\n",
      "Evaluating model...\n",
      "Test Accuracy: 0.9645\n",
      "Test Precision: 0.9524\n",
      "Test Recall: 0.9677\n",
      "Test F1-Score: 0.9600\n",
      "\n",
      "--- Model Analysis ---\n"
     ]
    },
    {
     "data": {
      "image/png": "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eOONAo8FAH9EAgh4KH9/f0nSmTNnCnT9jz/+KC8vL9WqVcupPSQkRIGBgfrxxx+d2kNDQ/P1Ua5cOf3222/XGXF+Xbt2VVRUlB555BEFBwerW7duWrx48Z8mg5fjjIiIyHeubt26+vXXX3Xu3Dmn9iufpVy5cpLk0rO0bdtWZcuW1fvvv6+FCxfq1ltvzfezvCwvL0+TJ09WeHi47Ha7brrpJlWoUEFff/21MjMzCzzmP/7xD5de+HjllVdUvnx57dmzR1OnTlXFihULfC8A/BEJIOCh/P39VblyZe3bt8+l+658CeNaSpQocdV2wzCue4zL69Mu8/X11Weffab169frP//5j77++mt17dpVbdq0yXft3/F3nuUyu92uTp06ad68eVq2bNk1q3+SNH78eMXGxqp58+Z65513tGbNGq1bt07169cvcKVT+v3n44rdu3fr+PHjkqS9e/e6dC8A/BEJIODB2rVrp0OHDik5Ofkvrw0LC1NeXp4OHDjg1H7s2DFlZGQ43ugtDOXKlXN6Y/ayK6uMkuTl5aV77rlHkyZN0rfffqsXX3xRGzZs0MaNG6/a9+U4U1JS8p3bv3+/brrpJpUpU+bvPcA1PPzww9q9e7fOnDlz1RdnLvvggw/UsmVLzZ49W926ddO9996r1q1b5/uZFDQZL4hz586pT58+qlevnvr376+JEydqx44dhdY/AGshAQQ82MiRI1WmTBk98sgjOnbsWL7zhw4d0muvvSbp9ylMSfne1J00aZIk6f777y+0uGrWrKnMzEx9/fXXjra0tDQtW7bM6bpTp07lu/fyhshXbk1zWaVKldSkSRPNmzfPKaHat2+f1q5d63hOd2jZsqWef/55vf766woJCbnmdSVKlMhXXVyyZIl++eUXp7bLierVkmVXjRo1SqmpqZo3b54mTZqkatWqKSYm5po/RwD4M2wEDXiwmjVratGiReratavq1q3r9E0gW7du1ZIlS9S7d29JUuPGjRUTE6M333xTGRkZatGihb744gvNmzdPHTt2vOYWI9ejW7duGjVqlB588EE99dRTysrK0owZM1S7dm2nlyASEhL02Wef6f7771dYWJiOHz+u6dOnq0qVKrrzzjuv2f/LL7+s++67T5GRkerXr5/Onz+vadOmKSAgQGPHji2057iSl5eXnnvuub+8rl27dkpISFCfPn10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tWzZ0vH58vrBmJgYzZ07VyNHjtS5c+fUv39/ZWRk6M4779Tq1avl4+NT4DFshmEYhR65ybIvmR0BAHepOWiZ2SEAcJNfZjxo2thHMy64re/Kgd5u6/t6sQYQAADAYpgCBgAAludJU8BFgQogAACAxVABBAAAlmcr5O1aPB0VQAAAAIuhAggAAGCtAiAVQAAAAKuhAggAACzPYgVAEkAAAAC2gQEAAECxRgUQAABYHtvAAAAAoFijAggAAGCtAiAVQAAAAKuhAggAACzPYgVAKoAAAABWQwUQAABYntX2ASQBBAAAlsc2MAAAACjWqAACAADLs9oUMBVAAAAAiyEBBAAAsBgSQAAAAIthDSAAALA81gACAACgWKMCCAAALM9q+wCSAAIAAMtjChgAAADFGhVAAABgeRYrAFIBBAAAsBoqgAAAABYrAVIBBAAAsBgqgAAAwPKstg0MFUAAAACLoQIIAAAsj30AAQAAUKxRAQQAAJZnsQIgCSAAAIDVMkCmgAEAACyGCiAAALA8toEBAABAsUYFEAAAWB7bwAAAAKBYsxmGYZgdBHC9cnJylJiYqLi4ONntdrPDAVCI+P0G3IcEEDe006dPKyAgQJmZmfL39zc7HACFiN9vwH2YAgYAALAYEkAAAACLIQEEAACwGBJA3NDsdrvGjBnDAnGgGOL3G3AfXgIBAACwGCqAAAAAFkMCCAAAYDEkgAAAABZDAogiYbPZtHz5crPDAABt2rRJNptNGRkZZocCmIYEEH9benq6Bg8erFq1asnHx0fBwcGKiorSjBkzlJWVZXZ4ANyod+/estlsmjBhglP78uXLZbPZTIoKwF8hAcTfcvjwYd18881au3atxo8fr927dys5OVkjR47UypUrtX79erNDBOBmPj4+eumll/Tbb78VWp8XLlwotL4A5EcCiL/lySefVMmSJbVz50516dJFdevWVY0aNdShQwetWrVK7du3v+p9o0aNUu3atVW6dGnVqFFD8fHxunjxouN879691bFjR6d7hgwZorvvvtvxOS8vTxMnTlStWrVkt9sVGhqqF1980XF+7969atWqlXx9fRUUFKT+/fvr7Nmz+cYYP368goODFRgYqISEBF26dEkjRoxQ+fLlVaVKFc2ZM8el2AGrad26tUJCQpSYmHjNaz788EPVr19fdrtd1apV06uvvup0vlq1anr++efVq1cv+fv7q3///po7d64CAwO1cuVKRUREqHTp0nrooYeUlZWlefPmqVq1aipXrpyeeuop5ebmOvpasGCBmjVrprJlyyokJEQPP/ywjh8/7rbnB25EJIC4bidPntTatWs1YMAAlSlT5qrXXGsKqGzZspo7d66+/fZbvfbaa5o1a5YmT57s0vhxcXGaMGGC4uPj9e2332rRokUKDg6WJJ07d07R0dEqV66cduzYoSVLlmj9+vUaOHCgUx8bNmzQ0aNH9dlnn2nSpEkaM2aM2rVrp3Llymn79u16/PHH9dhjj+nnn38u1NiB4qREiRIaP368pk2b5vS7ctmuXbvUpUsXdevWTXv37tXYsWMVHx+vuXPnOl33yiuvqHHjxtq9e7fi4+MlSVlZWZo6daree+89rV69Wps2bdKDDz6oTz75RJ988okWLFigN954Qx988IGjn4sXL+r555/XV199peXLl+uHH35Q79693fkjAG48BnCdtm3bZkgyli5d6tQeFBRklClTxihTpowxcuRIwzAMQ5KxbNmya/b18ssvG02bNnV8jomJMTp06OB0zeDBg40WLVoYhmEYp0+fNux2uzFr1qyr9vfmm28a5cqVM86ePetoW7VqleHl5WWkp6c7xggLCzNyc3Md10RERBh33XWX4/OlS5eMMmXKGO+++26BYwes5I+/q7fffrvRt29fwzAMY9myZcblf8U8/PDDRps2bZzuGzFihFGvXj3H57CwMKNjx45O18yZM8eQZBw8eNDR9thjjxmlS5c2zpw542iLjo42HnvssWvGuGPHDkOS456NGzcakozffvvN9QcGigkqgCh0X3zxhfbs2aP69esrJyfnqte8//77ioqKUkhIiPz8/PTcc88pNTW1wGN89913ysnJ0T333HPN840bN3aqTEZFRSkvL08pKSmOtvr168vL63+/BsHBwWrYsKHjc4kSJRQUFOQ0ffR3YweKq5deeknz5s3Td99959T+3XffKSoqyqktKipKBw4ccJq6bdasWb4+S5curZo1azo+BwcHq1q1avLz83Nq++Pv6K5du9S+fXuFhoaqbNmyatGihSTxewr8AQkgrlutWrVks9mcEipJqlGjhmrVqiVfX9+r3pecnKwePXqobdu2WrlypXbv3q1nn33WadG3l5eXjCu+pfCP6+yu1berSpUq5fTZ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\n",
      "text/plain": [
       "<Figure size 800x600 with 2 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Sample of Actual vs. Predicted Labels:\n",
      "Sample 1: Actual: glaucoma, Predicted: glaucoma\n",
      "Sample 2: Actual: glaucoma, Predicted: glaucoma\n",
      "Sample 3: Actual: glaucoma, Predicted: glaucoma\n",
      "Sample 4: Actual: glaucoma, Predicted: glaucoma\n",
      "Sample 5: Actual: glaucoma, Predicted: glaucoma\n",
      "Sample 6: Actual: glaucoma, Predicted: glaucoma\n",
      "Sample 7: Actual: glaucoma, Predicted: glaucoma\n",
      "Sample 8: Actual: glaucoma, Predicted: normal\n",
      "Sample 9: Actual: glaucoma, Predicted: glaucoma\n",
      "Sample 10: Actual: glaucoma, Predicted: glaucoma\n",
      "\n",
      "Model saved to glaucoma_vit_model.pth\n"
     ]
    }
   ],
   "source": [
    "import os\n",
    "import torch\n",
    "import torch.nn as nn\n",
    "from torch.utils.data import Dataset, DataLoader\n",
    "from torchvision import transforms, models\n",
    "from PIL import Image\n",
    "from sklearn.metrics import accuracy_score, precision_score, recall_score, f1_score, confusion_matrix\n",
    "import glob\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "\n",
    "DATA_DIR = \"/kaggle/input/glaucoma-dataset/ACRIMA\"\n",
    "PARTITIONED_DIR = os.path.join(DATA_DIR, \"PARTITIONED\")\n",
    "TRAIN_DIR = os.path.join(PARTITIONED_DIR, \"Training\")\n",
    "TEST_DIR = os.path.join(PARTITIONED_DIR, \"Testing\")\n",
    "\n",
    "DEVICE = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")\n",
    "\n",
    "BATCH_SIZE = 20\n",
    "LEARNING_RATE = 1e-4\n",
    "NUM_EPOCHS = 20\n",
    "IMAGE_SIZE = 224\n",
    "\n",
    "class GlaucomaDataset(Dataset):\n",
    "    def __init__(self, root_dir, transform=None):\n",
    "        self.root_dir = root_dir\n",
    "        self.transform = transform\n",
    "        self.classes = [\"glaucoma\", \"normal\"]\n",
    "        self.image_paths = []\n",
    "        self.labels = []\n",
    "\n",
    "        image_extensions = (\".jpg\", \".jpeg\", \".png\", \".bmp\", \".gif\")\n",
    "\n",
    "        for class_name in self.classes:\n",
    "            class_path = os.path.join(self.root_dir, class_name)\n",
    "            for img_path in glob.glob(os.path.join(class_path, \"*\")):\n",
    "                if img_path.lower().endswith(image_extensions):\n",
    "                    self.image_paths.append(img_path)\n",
    "                    self.labels.append(self.classes.index(class_name))\n",
    "        \n",
    "        if not self.image_paths:\n",
    "            print(f\"Warning: No images found in {root_dir} with extensions {image_extensions}.\")\n",
    "\n",
    "    def __len__(self):\n",
    "        return len(self.image_paths)\n",
    "\n",
    "    def __getitem__(self, idx):\n",
    "        img_path = self.image_paths[idx]\n",
    "        image = Image.open(img_path).convert(\"RGB\")\n",
    "        label = self.labels[idx]\n",
    "\n",
    "        if self.transform:\n",
    "            image = self.transform(image)\n",
    "\n",
    "        return image, label\n",
    "\n",
    "data_transforms = {\n",
    "    \"train\": transforms.Compose([\n",
    "        transforms.Resize(IMAGE_SIZE),\n",
    "        transforms.CenterCrop(IMAGE_SIZE),\n",
    "        transforms.ToTensor(),\n",
    "        transforms.Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225]),\n",
    "    ]),\n",
    "    \"val\": transforms.Compose([\n",
    "        transforms.Resize(IMAGE_SIZE),\n",
    "        transforms.CenterCrop(IMAGE_SIZE),\n",
    "        transforms.ToTensor(),\n",
    "        transforms.Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225]),\n",
    "    ])\n",
    "}\n",
    "\n",
    "def get_model():\n",
    "    model = models.vit_b_16(pretrained=True)\n",
    "    \n",
    "    for param in model.parameters():\n",
    "        param.requires_grad = False\n",
    "\n",
    "    in_features = model.heads.head.in_features\n",
    "    model.heads.head = nn.Linear(in_features, 2)\n",
    "    \n",
    "    print(\"Using Vision Transformer (ViT) model: ViT-B/16\")\n",
    "    \n",
    "    return model\n",
    "\n",
    "def train_model(model, train_loader, criterion, optimizer, num_epochs):\n",
    "    model.train()\n",
    "    print(\"Starting training...\")\n",
    "    for epoch in range(num_epochs):\n",
    "        running_loss = 0.0\n",
    "        for i, (images, labels) in enumerate(train_loader):\n",
    "            images = images.to(DEVICE)\n",
    "            labels = labels.to(DEVICE)\n",
    "\n",
    "            outputs = model(images)\n",
    "            loss = criterion(outputs, labels)\n",
    "\n",
    "            optimizer.zero_grad()\n",
    "            loss.backward()\n",
    "            optimizer.step()\n",
    "\n",
    "            running_loss += loss.item() * images.size(0)\n",
    "\n",
    "        epoch_loss = running_loss / len(train_loader.dataset)\n",
    "        print(f\"Epoch [{epoch+1}/{num_epochs}], Loss: {epoch_loss:.4f}\")\n",
    "    print(\"Training finished.\")\n",
    "\n",
    "def evaluate_model(model, test_loader):\n",
    "    model.eval()\n",
    "    print(\"Evaluating model...\")\n",
    "    all_preds = []\n",
    "    all_labels = []\n",
    "\n",
    "    with torch.no_grad():\n",
    "        for images, labels in test_loader:\n",
    "            images = images.to(DEVICE)\n",
    "            labels = labels.to(DEVICE)\n",
    "            outputs = model(images)\n",
    "            _, predicted = torch.max(outputs.data, 1)\n",
    "            \n",
    "            all_preds.extend(predicted.cpu().numpy())\n",
    "            all_labels.extend(labels.cpu().numpy())\n",
    "\n",
    "    accuracy = accuracy_score(all_labels, all_preds)\n",
    "    precision = precision_score(all_labels, all_preds, average='binary')\n",
    "    recall = recall_score(all_labels, all_preds, average='binary')\n",
    "    f1 = f1_score(all_labels, all_preds, average='binary')\n",
    "\n",
    "    print(f\"Test Accuracy: {accuracy:.4f}\")\n",
    "    print(f\"Test Precision: {precision:.4f}\")\n",
    "    print(f\"Test Recall: {recall:.4f}\")\n",
    "    print(f\"Test F1-Score: {f1:.4f}\")\n",
    "    \n",
    "    return all_labels, all_preds\n",
    "\n",
    "if __name__ == \"__main__\":\n",
    "    train_dataset = GlaucomaDataset(root_dir=TRAIN_DIR, transform=data_transforms[\"train\"])\n",
    "    test_dataset = GlaucomaDataset(root_dir=TEST_DIR, transform=data_transforms[\"val\"])\n",
    "\n",
    "    train_loader = DataLoader(train_dataset, batch_size=BATCH_SIZE, shuffle=True)\n",
    "    test_loader = DataLoader(test_dataset, batch_size=BATCH_SIZE, shuffle=False)\n",
    "\n",
    "    model = get_model().to(DEVICE)\n",
    "    criterion = nn.CrossEntropyLoss()\n",
    "    optimizer = torch.optim.Adam(model.parameters(), lr=LEARNING_RATE)\n",
    "\n",
    "    train_model(model, train_loader, criterion, optimizer, NUM_EPOCHS)\n",
    "\n",
    "    true_labels, predicted_labels = evaluate_model(model, test_loader)\n",
    "\n",
    "    print(\"\\n--- Model Analysis ---\")\n",
    "\n",
    "    cm = confusion_matrix(true_labels, predicted_labels)\n",
    "    plt.figure(figsize=(8, 6))\n",
    "    sns.heatmap(cm, annot=True, fmt='d', cmap='Blues', xticklabels=['Glaucoma', 'Normal'], yticklabels=['Glaucoma', 'Normal'])\n",
    "    plt.title('Confusion Matrix')\n",
    "    plt.xlabel('Predicted Label')\n",
    "    plt.ylabel('True Label')\n",
    "    plt.show()\n",
    "\n",
    "    print(\"\\nSample of Actual vs. Predicted Labels:\")\n",
    "    for i in range(10):\n",
    "        actual_class = test_dataset.classes[true_labels[i]]\n",
    "        predicted_class = test_dataset.classes[predicted_labels[i]]\n",
    "        print(f\"Sample {i+1}: Actual: {actual_class}, Predicted: {predicted_class}\")\n",
    "\n",
    "    model_filename = \"glaucoma_vit_model.pth\"\n",
    "   \n",
    "    torch.save(model.state_dict(), model_filename)\n",
    "    print(f\"\\nModel saved to {model_filename}\")\n"
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "gpu",
   "dataSources": [
    {
     "datasetId": 8081235,
     "sourceId": 12782274,
     "sourceType": "datasetVersion"
    }
   ],
   "dockerImageVersionId": 31090,
   "isGpuEnabled": true,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.13"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 190.449342,
   "end_time": "2025-08-17T15:50:53.671833",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2025-08-17T15:47:43.222491",
   "version": "2.6.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
